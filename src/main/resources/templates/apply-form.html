<!doctype html>
<html lang="tr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Şirket Başvurusu</title>
    <script th:src="'https://www.google.com/recaptcha/api.js?render=' + ${siteKey}"></script>
    <style>
        :root{--b:#e5e7eb;--muted:#6b7280;}
        body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;max-width:650px;margin:40px auto;padding:0 16px;}
        h2{margin-bottom:6px;color:#cf7ce9}
        .muted{color:var(--muted);font-size:14px;margin-top:0}
        .card{margin-top:18px;padding:32px;border:1px solid var(--b);border-radius:16px;box-shadow:0 4px 16px rgba(0,0,0,.06)}
        label{display:block;margin:12px 0 12px;font-weight:600}
        input{width:96%;padding:11px;border:1px solid var(--b);border-radius:10px}
        small{color:var(--muted)}
        button{margin-top:16px;padding:12px 16px;border:0;border-radius:10px;background:#f9a9d5;color:#fff;cursor:pointer;transition:background .2s}
        button:hover{background:#f472b6}
    </style>
</head>
<body>
<h2>Şirket Başvurusu</h2>
<p class="muted">Lütfen bilgileri eksiksiz doldurun.</p>

<div class="card">
    <form id="applyForm" method="post" th:action="@{/api/companies/apply-form}">
        <label>Şirket Adı</label>
        <input type="text" name="name" required minlength="2" maxlength="100"/>

        <label>E-posta</label>
        <input type="email" name="email" required maxlength="254"/>

        <label>Telefon <small>(E.164: +905xxxxxxxxx)</small></label>
        <input type="tel" name="phone" required
               pattern="^\+[1-9]\d{7,14}$"
               title="Telefon E.164 formatında olmalı, örn: +905xxxxxxxxx"/>

        <label>Çalışan Sayısı</label>
        <input type="number" name="employeeCount" required min="1" max="100000"/>

        <input type="hidden" name="recaptchaToken" id="recaptchaToken"/>
        <button type="submit">Başvuruyu Gönder</button>
    </form>
</div>

<script th:inline="javascript">

    const siteKey = /*[[${siteKey}]]*/ "";
    const form = document.getElementById("applyForm");

    form.addEventListener("submit", function(e) {
        e.preventDefault();
        if (!window.grecaptcha) {
            alert("reCAPTCHA yüklenemedi (grecaptcha yok).");
            return;
        }
        grecaptcha.ready(function () {
            grecaptcha.execute(siteKey, { action: "apply" })
                .then(function (token) {
                    document.getElementById("recaptchaToken").value = token;
                    form.submit();
                })
                .catch(function (err) {
                    alert("reCAPTCHA hatası: " + (err?.message || JSON.stringify(err)));
                });
        });
    });
</script>

</body>
</html>
