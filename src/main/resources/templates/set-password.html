<!doctype html>
<html lang="tr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Şifre Belirle</title>
    <script th:src="'https://www.google.com/recaptcha/api.js?render=' + ${siteKey}"></script>
    <style>
        :root { --bg:#0b1220; --card:#ffffff; --border:#e5e7eb; --text:#111827; --muted:#6b7280; --primary:#FF69B4; --primary-hover:#172c6c; }
        *{box-sizing:border-box} html,body{height:100%;margin:0}
        body{background:radial-gradient(1200px 800px at 20% 0%, rgba(30,58,138,.12), transparent 50%) no-repeat,
        radial-gradient(1000px 600px at 120% -20%, rgba(30,58,138,.10), transparent 50%) no-repeat, #f8fafc;
            font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif; display:flex;align-items:center;justify-content:center;padding:24px;color:var(--text)}
        .card{width:100%;max-width:480px;background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 20px 40px rgba(2,6,23,.08);padding:28px}
        h2{margin:0 0 4px;font-size:22px}.sub{margin:0 0 18px;color:var(--muted);font-size:14px}
        label{display:block;margin:14px 0 6px;font-weight:600;font-size:14px}
        input[type="text"],input[type="password"]{width:100%;padding:14px 12px;border:1px solid var(--border);border-radius:12px;font-size:16px;outline:none;transition:box-shadow .15s ease,border-color .15s ease;background:#fff}
        input:focus{border-color:var(--primary);box-shadow:0 0 0 4px rgba(30,58,138,.12)}
        .hint{color:var(--muted);font-size:12px;margin-top:4px}
        button{width:100%;margin-top:18px;padding:14px 16px;border:0;border-radius:12px;font-size:16px;font-weight:600;letter-spacing:.2px;color:#fff;background:linear-gradient(180deg,var(--primary),var(--primary-hover));cursor:pointer;transform:translateZ(0);transition:filter .15s ease, transform .02s ease-in-out, box-shadow .15s ease; box-shadow:0 10px 20px rgba(30,58,138,.18), 0 3px 8px rgba(0,0,0,.08)}
        button:hover{filter:brightness(1.02)} button:active{transform:translateY(1px)}
        .row{display:flex;gap:12px}.row>div{flex:1}
        @media (max-width:520px){.row{flex-direction:column}}
        .error { color:#991b1b; font-size:12px; margin-top:6px; display:none; }
    </style>
</head>
<body>
<div class="card">
    <h2>Şifre Belirleme</h2>
    <p class="sub">Lütfen mailinize gelen token ile yeni şifrenizi girin.</p>

    <form id="passwordForm" method="post" th:action="@{/api/companies/set-password}">
        <label>Maildeki Token</label>
        <input type="text" name="token" required placeholder="Örn: 7b1a2c..."/>

        <label>Şifre</label>
        <input type="password" name="password"
               required minlength="8"
               pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*\d)\S{8,}"
               title="En az 8 karakter, 1 büyük, 1 küçük, 1 rakam; boşluk yok."
               autocomplete="new-password" spellcheck="false"
               onkeydown="if (event.key === ' ') event.preventDefault();"
               oninput="this.value = this.value.replace(/\s+/g,'');" />
        <div class="hint">En az 1 büyük, 1 küçük, 1 rakam; boşluk yok.</div>

        <input type="hidden" name="recaptchaToken" id="recaptchaToken" />
        <button type="submit">Gönder</button>
    </form>
</div>

<script th:inline="javascript">
    const siteKey = /*[[${siteKey}]]*/ "";
    document.getElementById("passwordForm").addEventListener("submit", function(e) {
        e.preventDefault();
        grecaptcha.ready(function () {
            grecaptcha.execute(siteKey, { action: "set_password" }).then(function (token) {
                document.getElementById("recaptchaToken").value = token;
                document.getElementById("passwordForm").submit();
            });
        });
    });
</script>
</body>
</html>
